<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Meta3 Hypergraph</title>
  <style>
    :root {{
      --bg: #070813;
      --panel: rgba(16, 19, 38, 0.86);
      --panel2: rgba(16, 19, 38, 0.62);
      --border: rgba(120, 160, 255, 0.22);
      --text: #e9efff;
      --muted: #9fb2d8;
      --accent: #7aa7ff;
      --hot: #ff5d8f;
      --ok: #41d6b2;
      --warn: #ffd166;
    }}
    html, body {{ height: 100%; }}
    body {{
      margin: 0;
      overflow: hidden;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1200px 800px at 20% 30%, rgba(122,167,255,0.18), transparent 55%),
        radial-gradient(900px 650px at 80% 70%, rgba(255,93,143,0.14), transparent 50%),
        var(--bg);
      color: var(--text);
    }}
    #hud {{
      position: fixed; inset: 12px 12px auto 12px;
      display: grid; grid-template-columns: 1fr auto;
      gap: 10px; align-items: start; z-index: 10;
      pointer-events: none;
    }}
    #card {{
      pointer-events: auto;
      padding: 12px 14px;
      border: 1px solid var(--border);
      background: var(--panel);
      backdrop-filter: blur(10px);
      border-radius: 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      min-width: 320px;
    }}
    #title {{ font-weight: 800; letter-spacing: 0.3px; }}
    #subtitle {{ color: var(--muted); font-size: 12px; margin-top: 2px; }}
    #metrics {{ margin-top: 10px; display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 10px; }}
    .m {{ padding: 10px; border-radius: 12px; background: var(--panel2); border: 1px solid rgba(255,255,255,0.06); }}
    .mv {{ font-size: 18px; font-weight: 800; }}
    .ml {{ font-size: 11px; color: var(--muted); margin-top: 2px; }}
    #controls {{ margin-top: 10px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }}
    .btn {{ pointer-events: auto; cursor: pointer; border: 1px solid var(--border); background: rgba(9, 12, 24, 0.65); color: var(--text); padding: 8px 10px; border-radius: 12px; font-size: 12px; }}
    .btn:hover {{ border-color: rgba(122,167,255,0.6); }}
    #turnWrap {{ pointer-events: auto; display: flex; gap: 8px; align-items: center; }}
    #turn {{ width: 260px; }}
    #links {{ pointer-events: auto; display: flex; gap: 10px; justify-content: flex-end; }}
    #links a {{ color: var(--accent); text-decoration: none; font-size: 12px; padding: 9px 10px; border-radius: 12px; border: 1px solid var(--border); background: rgba(9, 12, 24, 0.65); }}
    #links a:hover {{ border-color: rgba(122,167,255,0.6); }}
    #canvas {{ position: fixed; inset: 0; }}
    #tip {{
      position: fixed; left: 0; top: 0; transform: translate(-9999px, -9999px);
      max-width: 420px;
      padding: 10px 12px;
      background: rgba(8, 10, 20, 0.92);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      font-size: 12px;
      color: var(--text);
      box-shadow: 0 12px 26px rgba(0,0,0,0.45);
      white-space: pre-wrap;
      z-index: 20;
      pointer-events: none;
    }}
    #tip .k {{ color: var(--muted); font-size: 11px; }}
    #hint {{ position: fixed; right: 12px; bottom: 12px; padding: 10px 12px; border: 1px solid rgba(255,255,255,0.08); background: rgba(16,19,38,0.6); border-radius: 12px; color: var(--muted); font-size: 12px; }}
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <div id="hud">
    <div id="card">
      <div id="title">Meta3 Hypergraph</div>
      <div id="subtitle">Hierarchical causal structure (run → goal → turns → tools → outcomes).</div>
      <div id="metrics">
        <div class="m"><div class="mv" id="mNodes">–</div><div class="ml">Nodes</div></div>
        <div class="m"><div class="mv" id="mEdges">–</div><div class="ml">Causal Links</div></div>
        <div class="m"><div class="mv" id="mCx">–</div><div class="ml">Complexity (E/N)</div></div>
        <div class="m"><div class="mv" id="mMerge">–</div><div class="ml">Confluence</div></div>
      </div>
      <div id="controls">
        <button class="btn" id="btnPulse">Pulse</button>
        <button class="btn" id="btnReset">Recenter</button>
        <div id="turnWrap">
          <span style="color:var(--muted); font-size:12px;">Turn</span>
          <input id="turn" type="range" min="0" max="0" value="0" />
          <span id="turnVal" style="font-size:12px; color:var(--muted);">0</span>
        </div>
      </div>
    </div>
    <div id="links">
      <a id="aJson" href="#">hypergraph.json</a>
      <a id="aDot" href="#">hypergraph.dot</a>
    </div>
  </div>
  <div id="tip"></div>
  <div id="hint">Drag to pan · Wheel to zoom · Hover for details · Turn slider = hierarchy</div>
  <script>
    const GRAPH = {"id":"capability-catalog","nodes":[{"id":"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json","kind":"catalog","label":"capabilities.json","data":{"path":"/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"}},{"id":"CAPKEY:nstar.core.0","kind":"capability_key","label":"nstar.core.0"},{"id":"CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1","kind":"capability","label":"AGI Solver","data":{"catalog_id":"nstar.core.0","description":"Optimal Path Finding","name":"AGI Solver","source":"src/nstar.rs","triggers":"'solve', 'agi', or 'optimal'","type":"kernel_interception"}},{"id":"FILE:src/nstar.rs","kind":"file","label":"nstar.rs","data":{"path":"src/nstar.rs"}},{"id":"DIR:src","kind":"dir","label":"src","data":{"path":"src"}},{"id":"TRIGGER:66dbb6b3e122e6d237695ed8e8b9a19945660ce16cb0504a4f44d534554403be","kind":"trigger","label":"'solve', 'agi', or 'optimal'","data":{"text":"'solve', 'agi', or 'optimal'"}},{"id":"CAPTYPE:kernel_interception","kind":"capability_type","label":"kernel_interception"},{"id":"CAPKEY:nstar.core.0a","kind":"capability_key","label":"nstar.core.0a"},{"id":"CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1","kind":"capability","label":"TSP","data":{"catalog_id":"nstar.core.0a","description":"Traveling Salesman Problem - Ruliad Way","name":"TSP","source":"src/nstar.rs","triggers":"'tsp', 'salesman', 'tour'","type":"kernel_interception"}},{"id":"TRIGGER:a6e4cdbc7a35c2854320f9679a25fc3c57053bb8396ffe0ad658aa126115c212","kind":"trigger","label":"'tsp', 'salesman', 'tour'","data":{"text":"'tsp', 'salesman', 'tour'"}},{"id":"CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2","kind":"capability","label":"LEARNING SOLVER","data":{"catalog_id":"nstar.core.0a","description":"Heuristic + Multiway Verification","name":"LEARNING SOLVER","source":"src/nstar.rs","triggers":"'solve', 'learn', or 'optimize'","type":"kernel_interception"}},{"id":"TRIGGER:91827eb3ecc331ba7066b9c58ea2266242e7de9d11b1283febd829a65d2c1031","kind":"trigger","label":"'solve', 'learn', or 'optimize'","data":{"text":"'solve', 'learn', or 'optimize'"}},{"id":"CAPKEY:nstar.core.0b","kind":"capability_key","label":"nstar.core.0b"},{"id":"CAPABILITY:catalog:nstar.core.0b@f091cc689957:1","kind":"capability","label":"Ruliad","data":{"catalog_id":"nstar.core.0b","description":"Formal Rewrite System - Wolfram Physics","name":"Ruliad","source":"src/nstar.rs","triggers":"'ruliad', 'rewrite', 'multiway'","type":"kernel_interception"}},{"id":"TRIGGER:11abf84658f71be1e444b8f346318135363f642ffdee2b51bdf9bd614e0d15ef","kind":"trigger","label":"'ruliad', 'rewrite', 'multiway'","data":{"text":"'ruliad', 'rewrite', 'multiway'"}},{"id":"CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2","kind":"capability","label":"Thought Tree","data":{"catalog_id":"nstar.core.0b","description":"ASCII Hierarchical Render","name":"Thought Tree","source":"src/nstar.rs","triggers":"'tree', 'thought', 'hierarchy'","type":"kernel_interception"}},{"id":"TRIGGER:b9fa345eb4191e43414601990ae4048ef1b1297e4f3fb119e4f894c8117a75de","kind":"trigger","label":"'tree', 'thought', 'hierarchy'","data":{"text":"'tree', 'thought', 'hierarchy'"}},{"id":"CAPKEY:nstar.core.0c","kind":"capability_key","label":"nstar.core.0c"},{"id":"CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1","kind":"capability","label":"Task Graph","data":{"catalog_id":"nstar.core.0c","description":"LLM-based Task Decomposition","name":"Task Graph","source":"src/nstar.rs","triggers":"'graph' or 'plan'  (for software engineering tasks)","type":"kernel_interception"}},{"id":"TRIGGER:fbd4dadf46ca0ba99af44fcbf23eff1751c3a26c4788d2b117d43684928cdaad","kind":"trigger","label":"'graph' or 'plan'  (for software engineering tasks)","data":{"text":"'graph' or 'plan'  (for software engineering tasks)"}},{"id":"CAPKEY:nstar.core.0d","kind":"capability_key","label":"nstar.core.0d"},{"id":"CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1","kind":"capability","label":"HyperGraph","data":{"catalog_id":"nstar.core.0d","description":"Meta6 Abstract Machine","name":"HyperGraph","source":"src/nstar.rs","triggers":"'hyper', 'signal', or 'traverse'","type":"kernel_interception"}},{"id":"TRIGGER:b29e86008c57550081d15b4602f5236a0c3d066f8ddfd2d890fcb679bf87b65f","kind":"trigger","label":"'hyper', 'signal', or 'traverse'","data":{"text":"'hyper', 'signal', or 'traverse'"}},{"id":"CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2","kind":"capability","label":"Hybrid Chat","data":{"catalog_id":"nstar.core.0c","description":"LLM + Graph Tracking","name":"Hybrid Chat","source":"src/nstar.rs","triggers":"'chat' keyword - tracks conversation as a graph","type":"kernel_interception"}},{"id":"TRIGGER:de22d067d8a802fe7e1ec134befa0ed1d4de6d68443958e856a8183af7ac44ed","kind":"trigger","label":"'chat' keyword - tracks conversation as a graph","data":{"text":"'chat' keyword - tracks conversation as a graph"}},{"id":"CAPKEY:bin.antigravity_history_explorer","kind":"capability_key","label":"bin.antigravity_history_explorer"},{"id":"CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1","kind":"capability","label":"antigravity_history_explorer","data":{"catalog_id":"bin.antigravity_history_explorer","description":"Standalone Utility: antigravity_history_explorer","name":"antigravity_history_explorer","source":"src/bin/antigravity_history_explorer.rs","triggers":"run antigravity_history_explorer [args]","type":"binary"}},{"id":"FILE:src/bin/antigravity_history_explorer.rs","kind":"file","label":"antigravity_history_explorer.rs","data":{"path":"src/bin/antigravity_history_explorer.rs"}},{"id":"DIR:src/bin","kind":"dir","label":"bin","data":{"path":"src/bin"}},{"id":"TRIGGER:9168022828297abce3eeab428d177e374dfea3aaa76b728ac1838662b7fb81ff","kind":"trigger","label":"run antigravity_history_explorer [args]","data":{"text":"run antigravity_history_explorer [args]"}},{"id":"CAPTYPE:binary","kind":"capability_type","label":"binary"},{"id":"CAPKEY:bin.amplify_signal","kind":"capability_key","label":"bin.amplify_signal"},{"id":"CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1","kind":"capability","label":"amplify_signal","data":{"catalog_id":"bin.amplify_signal","description":"Standalone Utility: amplify_signal","name":"amplify_signal","source":"src/bin/amplify_signal.rs","triggers":"run amplify_signal [args]","type":"binary"}},{"id":"FILE:src/bin/amplify_signal.rs","kind":"file","label":"amplify_signal.rs","data":{"path":"src/bin/amplify_signal.rs"}},{"id":"TRIGGER:9472aa3e2b727ab2ae581a801769c12ca9370eabc1d03d1aca95af863c4c9075","kind":"trigger","label":"run amplify_signal [args]","data":{"text":"run amplify_signal [args]"}},{"id":"CAPKEY:bin.flux","kind":"capability_key","label":"bin.flux"},{"id":"CAPABILITY:catalog:bin.flux@697040be808e:1","kind":"capability","label":"flux","data":{"catalog_id":"bin.flux","description":"Standalone Utility: flux","name":"flux","source":"src/bin/flux.rs","triggers":"run flux [args]","type":"binary"}},{"id":"FILE:src/bin/flux.rs","kind":"file","label":"flux.rs","data":{"path":"src/bin/flux.rs"}},{"id":"TRIGGER:866d1332633136c76760b5865c4035c4c726e49a59adcc60b89b1dc85e8a12e9","kind":"trigger","label":"run flux [args]","data":{"text":"run flux [args]"}},{"id":"CAPKEY:bin.oracle","kind":"capability_key","label":"bin.oracle"},{"id":"CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1","kind":"capability","label":"oracle","data":{"catalog_id":"bin.oracle","description":"Standalone Utility: oracle","name":"oracle","source":"src/bin/oracle.rs","triggers":"run oracle [args]","type":"binary"}},{"id":"FILE:src/bin/oracle.rs","kind":"file","label":"oracle.rs","data":{"path":"src/bin/oracle.rs"}},{"id":"TRIGGER:5cd05eda935580a0c3db12386a870a8c3ee2ed7eb5073063956e154bebd2c1ef","kind":"trigger","label":"run oracle [args]","data":{"text":"run oracle [args]"}},{"id":"CAPKEY:bin.negentropy","kind":"capability_key","label":"bin.negentropy"},{"id":"CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1","kind":"capability","label":"negentropy","data":{"catalog_id":"bin.negentropy","description":"Standalone Utility: negentropy","name":"negentropy","source":"src/bin/negentropy.rs","triggers":"run negentropy [args]","type":"binary"}},{"id":"FILE:src/bin/negentropy.rs","kind":"file","label":"negentropy.rs","data":{"path":"src/bin/negentropy.rs"}},{"id":"TRIGGER:6deca86060d60978b5df9865690f811bd8256dbd35ab30370c6c04b07edfaff3","kind":"trigger","label":"run negentropy [args]","data":{"text":"run negentropy [args]"}},{"id":"CAPKEY:bin.interaction_hypergraph","kind":"capability_key","label":"bin.interaction_hypergraph"},{"id":"CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1","kind":"capability","label":"interaction_hypergraph","data":{"catalog_id":"bin.interaction_hypergraph","description":"Standalone Utility: interaction_hypergraph","name":"interaction_hypergraph","source":"src/bin/interaction_hypergraph.rs","triggers":"run interaction_hypergraph [args]","type":"binary"}},{"id":"FILE:src/bin/interaction_hypergraph.rs","kind":"file","label":"interaction_hypergraph.rs","data":{"path":"src/bin/interaction_hypergraph.rs"}},{"id":"TRIGGER:ec9905dacee6455c0f1344411302b8e801a54c1a7b953c2181d020d04e8f862c","kind":"trigger","label":"run interaction_hypergraph [args]","data":{"text":"run interaction_hypergraph [args]"}}],"hyperedges":[{"id":"capability_instance_of:0","kind":"capability_instance_of","causes":["CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1"],"effects":["CAPKEY:nstar.core.0"]},{"id":"catalog_lists_capability:0","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1"]},{"id":"dir_contains_file:0","kind":"dir_contains_file","causes":["DIR:src"],"effects":["FILE:src/nstar.rs"]},{"id":"file_defines_capability:0","kind":"file_defines_capability","causes":["FILE:src/nstar.rs"],"effects":["CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1"]},{"id":"trigger_invokes_capability:0","kind":"trigger_invokes_capability","causes":["TRIGGER:66dbb6b3e122e6d237695ed8e8b9a19945660ce16cb0504a4f44d534554403be"],"effects":["CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1"]},{"id":"capability_has_type:0","kind":"capability_has_type","causes":["CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1"],"effects":["CAPTYPE:kernel_interception"]},{"id":"capability_instance_of:1","kind":"capability_instance_of","causes":["CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1"],"effects":["CAPKEY:nstar.core.0a"]},{"id":"catalog_lists_capability:1","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1"]},{"id":"dir_contains_file:1","kind":"dir_contains_file","causes":["DIR:src"],"effects":["FILE:src/nstar.rs"]},{"id":"file_defines_capability:1","kind":"file_defines_capability","causes":["FILE:src/nstar.rs"],"effects":["CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1"]},{"id":"trigger_invokes_capability:1","kind":"trigger_invokes_capability","causes":["TRIGGER:a6e4cdbc7a35c2854320f9679a25fc3c57053bb8396ffe0ad658aa126115c212"],"effects":["CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1"]},{"id":"capability_has_type:1","kind":"capability_has_type","causes":["CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1"],"effects":["CAPTYPE:kernel_interception"]},{"id":"capability_instance_of:2","kind":"capability_instance_of","causes":["CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2"],"effects":["CAPKEY:nstar.core.0a"]},{"id":"catalog_lists_capability:2","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2"]},{"id":"dir_contains_file:2","kind":"dir_contains_file","causes":["DIR:src"],"effects":["FILE:src/nstar.rs"]},{"id":"file_defines_capability:2","kind":"file_defines_capability","causes":["FILE:src/nstar.rs"],"effects":["CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2"]},{"id":"trigger_invokes_capability:2","kind":"trigger_invokes_capability","causes":["TRIGGER:91827eb3ecc331ba7066b9c58ea2266242e7de9d11b1283febd829a65d2c1031"],"effects":["CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2"]},{"id":"capability_has_type:2","kind":"capability_has_type","causes":["CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2"],"effects":["CAPTYPE:kernel_interception"]},{"id":"capability_instance_of:3","kind":"capability_instance_of","causes":["CAPABILITY:catalog:nstar.core.0b@f091cc689957:1"],"effects":["CAPKEY:nstar.core.0b"]},{"id":"catalog_lists_capability:3","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:nstar.core.0b@f091cc689957:1"]},{"id":"dir_contains_file:3","kind":"dir_contains_file","causes":["DIR:src"],"effects":["FILE:src/nstar.rs"]},{"id":"file_defines_capability:3","kind":"file_defines_capability","causes":["FILE:src/nstar.rs"],"effects":["CAPABILITY:catalog:nstar.core.0b@f091cc689957:1"]},{"id":"trigger_invokes_capability:3","kind":"trigger_invokes_capability","causes":["TRIGGER:11abf84658f71be1e444b8f346318135363f642ffdee2b51bdf9bd614e0d15ef"],"effects":["CAPABILITY:catalog:nstar.core.0b@f091cc689957:1"]},{"id":"capability_has_type:3","kind":"capability_has_type","causes":["CAPABILITY:catalog:nstar.core.0b@f091cc689957:1"],"effects":["CAPTYPE:kernel_interception"]},{"id":"capability_instance_of:4","kind":"capability_instance_of","causes":["CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2"],"effects":["CAPKEY:nstar.core.0b"]},{"id":"catalog_lists_capability:4","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2"]},{"id":"dir_contains_file:4","kind":"dir_contains_file","causes":["DIR:src"],"effects":["FILE:src/nstar.rs"]},{"id":"file_defines_capability:4","kind":"file_defines_capability","causes":["FILE:src/nstar.rs"],"effects":["CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2"]},{"id":"trigger_invokes_capability:4","kind":"trigger_invokes_capability","causes":["TRIGGER:b9fa345eb4191e43414601990ae4048ef1b1297e4f3fb119e4f894c8117a75de"],"effects":["CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2"]},{"id":"capability_has_type:4","kind":"capability_has_type","causes":["CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2"],"effects":["CAPTYPE:kernel_interception"]},{"id":"capability_instance_of:5","kind":"capability_instance_of","causes":["CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1"],"effects":["CAPKEY:nstar.core.0c"]},{"id":"catalog_lists_capability:5","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1"]},{"id":"dir_contains_file:5","kind":"dir_contains_file","causes":["DIR:src"],"effects":["FILE:src/nstar.rs"]},{"id":"file_defines_capability:5","kind":"file_defines_capability","causes":["FILE:src/nstar.rs"],"effects":["CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1"]},{"id":"trigger_invokes_capability:5","kind":"trigger_invokes_capability","causes":["TRIGGER:fbd4dadf46ca0ba99af44fcbf23eff1751c3a26c4788d2b117d43684928cdaad"],"effects":["CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1"]},{"id":"capability_has_type:5","kind":"capability_has_type","causes":["CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1"],"effects":["CAPTYPE:kernel_interception"]},{"id":"capability_instance_of:6","kind":"capability_instance_of","causes":["CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1"],"effects":["CAPKEY:nstar.core.0d"]},{"id":"catalog_lists_capability:6","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1"]},{"id":"dir_contains_file:6","kind":"dir_contains_file","causes":["DIR:src"],"effects":["FILE:src/nstar.rs"]},{"id":"file_defines_capability:6","kind":"file_defines_capability","causes":["FILE:src/nstar.rs"],"effects":["CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1"]},{"id":"trigger_invokes_capability:6","kind":"trigger_invokes_capability","causes":["TRIGGER:b29e86008c57550081d15b4602f5236a0c3d066f8ddfd2d890fcb679bf87b65f"],"effects":["CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1"]},{"id":"capability_has_type:6","kind":"capability_has_type","causes":["CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1"],"effects":["CAPTYPE:kernel_interception"]},{"id":"capability_instance_of:7","kind":"capability_instance_of","causes":["CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2"],"effects":["CAPKEY:nstar.core.0c"]},{"id":"catalog_lists_capability:7","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2"]},{"id":"dir_contains_file:7","kind":"dir_contains_file","causes":["DIR:src"],"effects":["FILE:src/nstar.rs"]},{"id":"file_defines_capability:7","kind":"file_defines_capability","causes":["FILE:src/nstar.rs"],"effects":["CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2"]},{"id":"trigger_invokes_capability:7","kind":"trigger_invokes_capability","causes":["TRIGGER:de22d067d8a802fe7e1ec134befa0ed1d4de6d68443958e856a8183af7ac44ed"],"effects":["CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2"]},{"id":"capability_has_type:7","kind":"capability_has_type","causes":["CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2"],"effects":["CAPTYPE:kernel_interception"]},{"id":"capability_instance_of:8","kind":"capability_instance_of","causes":["CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1"],"effects":["CAPKEY:bin.antigravity_history_explorer"]},{"id":"catalog_lists_capability:8","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1"]},{"id":"dir_contains_file:8","kind":"dir_contains_file","causes":["DIR:src/bin"],"effects":["FILE:src/bin/antigravity_history_explorer.rs"]},{"id":"file_defines_capability:8","kind":"file_defines_capability","causes":["FILE:src/bin/antigravity_history_explorer.rs"],"effects":["CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1"]},{"id":"trigger_invokes_capability:8","kind":"trigger_invokes_capability","causes":["TRIGGER:9168022828297abce3eeab428d177e374dfea3aaa76b728ac1838662b7fb81ff"],"effects":["CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1"]},{"id":"capability_has_type:8","kind":"capability_has_type","causes":["CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1"],"effects":["CAPTYPE:binary"]},{"id":"capability_instance_of:9","kind":"capability_instance_of","causes":["CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1"],"effects":["CAPKEY:bin.amplify_signal"]},{"id":"catalog_lists_capability:9","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1"]},{"id":"dir_contains_file:9","kind":"dir_contains_file","causes":["DIR:src/bin"],"effects":["FILE:src/bin/amplify_signal.rs"]},{"id":"file_defines_capability:9","kind":"file_defines_capability","causes":["FILE:src/bin/amplify_signal.rs"],"effects":["CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1"]},{"id":"trigger_invokes_capability:9","kind":"trigger_invokes_capability","causes":["TRIGGER:9472aa3e2b727ab2ae581a801769c12ca9370eabc1d03d1aca95af863c4c9075"],"effects":["CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1"]},{"id":"capability_has_type:9","kind":"capability_has_type","causes":["CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1"],"effects":["CAPTYPE:binary"]},{"id":"capability_instance_of:10","kind":"capability_instance_of","causes":["CAPABILITY:catalog:bin.flux@697040be808e:1"],"effects":["CAPKEY:bin.flux"]},{"id":"catalog_lists_capability:10","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:bin.flux@697040be808e:1"]},{"id":"dir_contains_file:10","kind":"dir_contains_file","causes":["DIR:src/bin"],"effects":["FILE:src/bin/flux.rs"]},{"id":"file_defines_capability:10","kind":"file_defines_capability","causes":["FILE:src/bin/flux.rs"],"effects":["CAPABILITY:catalog:bin.flux@697040be808e:1"]},{"id":"trigger_invokes_capability:10","kind":"trigger_invokes_capability","causes":["TRIGGER:866d1332633136c76760b5865c4035c4c726e49a59adcc60b89b1dc85e8a12e9"],"effects":["CAPABILITY:catalog:bin.flux@697040be808e:1"]},{"id":"capability_has_type:10","kind":"capability_has_type","causes":["CAPABILITY:catalog:bin.flux@697040be808e:1"],"effects":["CAPTYPE:binary"]},{"id":"capability_instance_of:11","kind":"capability_instance_of","causes":["CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1"],"effects":["CAPKEY:bin.oracle"]},{"id":"catalog_lists_capability:11","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1"]},{"id":"dir_contains_file:11","kind":"dir_contains_file","causes":["DIR:src/bin"],"effects":["FILE:src/bin/oracle.rs"]},{"id":"file_defines_capability:11","kind":"file_defines_capability","causes":["FILE:src/bin/oracle.rs"],"effects":["CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1"]},{"id":"trigger_invokes_capability:11","kind":"trigger_invokes_capability","causes":["TRIGGER:5cd05eda935580a0c3db12386a870a8c3ee2ed7eb5073063956e154bebd2c1ef"],"effects":["CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1"]},{"id":"capability_has_type:11","kind":"capability_has_type","causes":["CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1"],"effects":["CAPTYPE:binary"]},{"id":"capability_instance_of:12","kind":"capability_instance_of","causes":["CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1"],"effects":["CAPKEY:bin.negentropy"]},{"id":"catalog_lists_capability:12","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1"]},{"id":"dir_contains_file:12","kind":"dir_contains_file","causes":["DIR:src/bin"],"effects":["FILE:src/bin/negentropy.rs"]},{"id":"file_defines_capability:12","kind":"file_defines_capability","causes":["FILE:src/bin/negentropy.rs"],"effects":["CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1"]},{"id":"trigger_invokes_capability:12","kind":"trigger_invokes_capability","causes":["TRIGGER:6deca86060d60978b5df9865690f811bd8256dbd35ab30370c6c04b07edfaff3"],"effects":["CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1"]},{"id":"capability_has_type:12","kind":"capability_has_type","causes":["CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1"],"effects":["CAPTYPE:binary"]},{"id":"capability_instance_of:13","kind":"capability_instance_of","causes":["CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1"],"effects":["CAPKEY:bin.interaction_hypergraph"]},{"id":"catalog_lists_capability:13","kind":"catalog_lists_capability","causes":["CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json"],"effects":["CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1"]},{"id":"dir_contains_file:13","kind":"dir_contains_file","causes":["DIR:src/bin"],"effects":["FILE:src/bin/interaction_hypergraph.rs"]},{"id":"file_defines_capability:13","kind":"file_defines_capability","causes":["FILE:src/bin/interaction_hypergraph.rs"],"effects":["CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1"]},{"id":"trigger_invokes_capability:13","kind":"trigger_invokes_capability","causes":["TRIGGER:ec9905dacee6455c0f1344411302b8e801a54c1a7b953c2181d020d04e8f862c"],"effects":["CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1"]},{"id":"capability_has_type:13","kind":"capability_has_type","causes":["CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1"],"effects":["CAPTYPE:binary"]}],"metadata":{"run_id":"showcase-capability-graph","generated_at":"2026-01-19T19:17:26Z","source":"capability_catalog"}};
    const DOT = "digraph G {\n  rankdir=LR;\n  node [shape=box, style=filled, fontname=\"Helvetica\"];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" [label=\"capabilities.json\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:nstar.core.0\" [label=\"nstar.core.0\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1\" [label=\"AGI Solver\", fillcolor=\"#A3B18A\"];\n  \"FILE:src/nstar.rs\" [label=\"nstar.rs\", fillcolor=\"#A3B18A\"];\n  \"DIR:src\" [label=\"src\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:66dbb6b3e122e6d237695ed8e8b9a19945660ce16cb0504a4f44d534554403be\" [label=\"'solve', 'agi', or 'optimal'\", fillcolor=\"#A3B18A\"];\n  \"CAPTYPE:kernel_interception\" [label=\"kernel_interception\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:nstar.core.0a\" [label=\"nstar.core.0a\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1\" [label=\"TSP\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:a6e4cdbc7a35c2854320f9679a25fc3c57053bb8396ffe0ad658aa126115c212\" [label=\"'tsp', 'salesman', 'tour'\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2\" [label=\"LEARNING SOLVER\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:91827eb3ecc331ba7066b9c58ea2266242e7de9d11b1283febd829a65d2c1031\" [label=\"'solve', 'learn', or 'optimize'\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:nstar.core.0b\" [label=\"nstar.core.0b\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0b@f091cc689957:1\" [label=\"Ruliad\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:11abf84658f71be1e444b8f346318135363f642ffdee2b51bdf9bd614e0d15ef\" [label=\"'ruliad', 'rewrite', 'multiway'\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2\" [label=\"Thought Tree\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:b9fa345eb4191e43414601990ae4048ef1b1297e4f3fb119e4f894c8117a75de\" [label=\"'tree', 'thought', 'hierarchy'\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:nstar.core.0c\" [label=\"nstar.core.0c\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1\" [label=\"Task Graph\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:fbd4dadf46ca0ba99af44fcbf23eff1751c3a26c4788d2b117d43684928cdaad\" [label=\"'graph' or 'plan'  (for software engineering tasks)\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:nstar.core.0d\" [label=\"nstar.core.0d\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1\" [label=\"HyperGraph\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:b29e86008c57550081d15b4602f5236a0c3d066f8ddfd2d890fcb679bf87b65f\" [label=\"'hyper', 'signal', or 'traverse'\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2\" [label=\"Hybrid Chat\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:de22d067d8a802fe7e1ec134befa0ed1d4de6d68443958e856a8183af7ac44ed\" [label=\"'chat' keyword - tracks conversation as a graph\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:bin.antigravity_history_explorer\" [label=\"bin.antigravity_history_explorer\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1\" [label=\"antigravity_history_explorer\", fillcolor=\"#A3B18A\"];\n  \"FILE:src/bin/antigravity_history_explorer.rs\" [label=\"antigravity_history_explorer.rs\", fillcolor=\"#A3B18A\"];\n  \"DIR:src/bin\" [label=\"bin\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:9168022828297abce3eeab428d177e374dfea3aaa76b728ac1838662b7fb81ff\" [label=\"run antigravity_history_explorer [args]\", fillcolor=\"#A3B18A\"];\n  \"CAPTYPE:binary\" [label=\"binary\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:bin.amplify_signal\" [label=\"bin.amplify_signal\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1\" [label=\"amplify_signal\", fillcolor=\"#A3B18A\"];\n  \"FILE:src/bin/amplify_signal.rs\" [label=\"amplify_signal.rs\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:9472aa3e2b727ab2ae581a801769c12ca9370eabc1d03d1aca95af863c4c9075\" [label=\"run amplify_signal [args]\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:bin.flux\" [label=\"bin.flux\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:bin.flux@697040be808e:1\" [label=\"flux\", fillcolor=\"#A3B18A\"];\n  \"FILE:src/bin/flux.rs\" [label=\"flux.rs\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:866d1332633136c76760b5865c4035c4c726e49a59adcc60b89b1dc85e8a12e9\" [label=\"run flux [args]\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:bin.oracle\" [label=\"bin.oracle\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1\" [label=\"oracle\", fillcolor=\"#A3B18A\"];\n  \"FILE:src/bin/oracle.rs\" [label=\"oracle.rs\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:5cd05eda935580a0c3db12386a870a8c3ee2ed7eb5073063956e154bebd2c1ef\" [label=\"run oracle [args]\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:bin.negentropy\" [label=\"bin.negentropy\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1\" [label=\"negentropy\", fillcolor=\"#A3B18A\"];\n  \"FILE:src/bin/negentropy.rs\" [label=\"negentropy.rs\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:6deca86060d60978b5df9865690f811bd8256dbd35ab30370c6c04b07edfaff3\" [label=\"run negentropy [args]\", fillcolor=\"#A3B18A\"];\n  \"CAPKEY:bin.interaction_hypergraph\" [label=\"bin.interaction_hypergraph\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1\" [label=\"interaction_hypergraph\", fillcolor=\"#A3B18A\"];\n  \"FILE:src/bin/interaction_hypergraph.rs\" [label=\"interaction_hypergraph.rs\", fillcolor=\"#A3B18A\"];\n  \"TRIGGER:ec9905dacee6455c0f1344411302b8e801a54c1a7b953c2181d020d04e8f862c\" [label=\"run interaction_hypergraph [args]\", fillcolor=\"#A3B18A\"];\n  \"CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1\" -> \"CAPKEY:nstar.core.0\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src\" -> \"FILE:src/nstar.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/nstar.rs\" -> \"CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:66dbb6b3e122e6d237695ed8e8b9a19945660ce16cb0504a4f44d534554403be\" -> \"CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0@1b1d392c7d8d:1\" -> \"CAPTYPE:kernel_interception\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1\" -> \"CAPKEY:nstar.core.0a\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src\" -> \"FILE:src/nstar.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/nstar.rs\" -> \"CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:a6e4cdbc7a35c2854320f9679a25fc3c57053bb8396ffe0ad658aa126115c212\" -> \"CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0a@d0fcbb9ebcaa:1\" -> \"CAPTYPE:kernel_interception\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2\" -> \"CAPKEY:nstar.core.0a\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src\" -> \"FILE:src/nstar.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/nstar.rs\" -> \"CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:91827eb3ecc331ba7066b9c58ea2266242e7de9d11b1283febd829a65d2c1031\" -> \"CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0a@3104d9e77741:2\" -> \"CAPTYPE:kernel_interception\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0b@f091cc689957:1\" -> \"CAPKEY:nstar.core.0b\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:nstar.core.0b@f091cc689957:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src\" -> \"FILE:src/nstar.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/nstar.rs\" -> \"CAPABILITY:catalog:nstar.core.0b@f091cc689957:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:11abf84658f71be1e444b8f346318135363f642ffdee2b51bdf9bd614e0d15ef\" -> \"CAPABILITY:catalog:nstar.core.0b@f091cc689957:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0b@f091cc689957:1\" -> \"CAPTYPE:kernel_interception\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2\" -> \"CAPKEY:nstar.core.0b\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src\" -> \"FILE:src/nstar.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/nstar.rs\" -> \"CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:b9fa345eb4191e43414601990ae4048ef1b1297e4f3fb119e4f894c8117a75de\" -> \"CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0b@0689e7ff219b:2\" -> \"CAPTYPE:kernel_interception\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1\" -> \"CAPKEY:nstar.core.0c\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src\" -> \"FILE:src/nstar.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/nstar.rs\" -> \"CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:fbd4dadf46ca0ba99af44fcbf23eff1751c3a26c4788d2b117d43684928cdaad\" -> \"CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0c@4a3bc6fbda6e:1\" -> \"CAPTYPE:kernel_interception\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1\" -> \"CAPKEY:nstar.core.0d\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src\" -> \"FILE:src/nstar.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/nstar.rs\" -> \"CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:b29e86008c57550081d15b4602f5236a0c3d066f8ddfd2d890fcb679bf87b65f\" -> \"CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0d@7c98e17d92ce:1\" -> \"CAPTYPE:kernel_interception\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2\" -> \"CAPKEY:nstar.core.0c\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src\" -> \"FILE:src/nstar.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/nstar.rs\" -> \"CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:de22d067d8a802fe7e1ec134befa0ed1d4de6d68443958e856a8183af7ac44ed\" -> \"CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:nstar.core.0c@2a5f09a0fce2:2\" -> \"CAPTYPE:kernel_interception\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1\" -> \"CAPKEY:bin.antigravity_history_explorer\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src/bin\" -> \"FILE:src/bin/antigravity_history_explorer.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/bin/antigravity_history_explorer.rs\" -> \"CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:9168022828297abce3eeab428d177e374dfea3aaa76b728ac1838662b7fb81ff\" -> \"CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:bin.antigravity_history_explorer@e5e03af9dd49:1\" -> \"CAPTYPE:binary\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1\" -> \"CAPKEY:bin.amplify_signal\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src/bin\" -> \"FILE:src/bin/amplify_signal.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/bin/amplify_signal.rs\" -> \"CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:9472aa3e2b727ab2ae581a801769c12ca9370eabc1d03d1aca95af863c4c9075\" -> \"CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:bin.amplify_signal@daa57a42973a:1\" -> \"CAPTYPE:binary\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:bin.flux@697040be808e:1\" -> \"CAPKEY:bin.flux\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:bin.flux@697040be808e:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src/bin\" -> \"FILE:src/bin/flux.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/bin/flux.rs\" -> \"CAPABILITY:catalog:bin.flux@697040be808e:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:866d1332633136c76760b5865c4035c4c726e49a59adcc60b89b1dc85e8a12e9\" -> \"CAPABILITY:catalog:bin.flux@697040be808e:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:bin.flux@697040be808e:1\" -> \"CAPTYPE:binary\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1\" -> \"CAPKEY:bin.oracle\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src/bin\" -> \"FILE:src/bin/oracle.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/bin/oracle.rs\" -> \"CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:5cd05eda935580a0c3db12386a870a8c3ee2ed7eb5073063956e154bebd2c1ef\" -> \"CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:bin.oracle@47f79dbf2c9c:1\" -> \"CAPTYPE:binary\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1\" -> \"CAPKEY:bin.negentropy\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src/bin\" -> \"FILE:src/bin/negentropy.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/bin/negentropy.rs\" -> \"CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:6deca86060d60978b5df9865690f811bd8256dbd35ab30370c6c04b07edfaff3\" -> \"CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:bin.negentropy@5677fa7dcd47:1\" -> \"CAPTYPE:binary\" [label=\"capability_has_type\", style=solid];\n  \"CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1\" -> \"CAPKEY:bin.interaction_hypergraph\" [label=\"capability_instance_of\", style=solid];\n  \"CATALOG:/Users/jobs/Desktop/tmp-meta3-engine-test/dist/meta3-engine-v0.5.0/config/capabilities.json\" -> \"CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1\" [label=\"catalog_lists_capability\", style=solid];\n  \"DIR:src/bin\" -> \"FILE:src/bin/interaction_hypergraph.rs\" [label=\"dir_contains_file\", style=solid];\n  \"FILE:src/bin/interaction_hypergraph.rs\" -> \"CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1\" [label=\"file_defines_capability\", style=solid];\n  \"TRIGGER:ec9905dacee6455c0f1344411302b8e801a54c1a7b953c2181d020d04e8f862c\" -> \"CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1\" [label=\"trigger_invokes_capability\", style=solid];\n  \"CAPABILITY:catalog:bin.interaction_hypergraph@dc2e600c0546:1\" -> \"CAPTYPE:binary\" [label=\"capability_has_type\", style=solid];\n}\n";
    const COLORS = {{
      run: "#ff8fab",
      goal: "#41d6b2",
      turn: "#7aa7ff",
      thought: "#ffd166",
      tool_call: "#b8c0ff",
      tool_result: "#e9efff",
      artifact_path: "#ffb703",
      other: "#a3b18a"
    }};
    const BASE_MASS = {{
      run: 120, goal: 100, turn: 70, thought: 60,
      tool_call: 55, tool_result: 45, artifact_path: 80, other: 40
    }};
    function clamp(v,a,b){{return Math.max(a,Math.min(b,v));}}
    function nodeTurn(n){{
      const d = n.data || {{}};
      if (typeof d.turn === "number") return d.turn;
      if (typeof d.index === "number") return d.index;
      return 0;
    }}
    function nodeMass(n, deg){{
      const kind = n.kind || "other";
      let m = BASE_MASS[kind] || BASE_MASS.other;
      const d = n.data || {{}};
      const text = (d.full_text || d.text || "");
      const textBoost = Math.log1p(String(text).length / 120) * 35;
      const degreeBoost = Math.log1p(deg) * 18;
      return m + textBoost + degreeBoost;
    }}
    function edgeWeight(e){{
      let w = 1;
      if (e.kind === "tool_effect") w += 0.8;
      if (e.kind === "invocation") w += 0.5;
      if (e.kind === "turn_exec") w += 0.3;
      const allowed = e.data && e.data.allowed;
      if (allowed === false) w += 1.4;
      w += clamp((e.effects?.length || 0) * 0.15, 0, 1.2);
      return w;
    }}
    function fmt2(x){{
      if (!isFinite(x)) return "–";
      return (Math.round(x*100)/100).toFixed(2);
    }}
    function build(graph){{
      const nodes = graph.nodes || [];
      const hyperedges = graph.hyperedges || [];
      const byId = new Map(nodes.map(n => [n.id, n]));
      const indeg = new Map();
      const outdeg = new Map();
      const edges = [];
      for (const he of hyperedges) {{
        const w = edgeWeight(he);
        for (const c of (he.causes || [])) {{
          for (const t of (he.effects || [])) {{
            if (!byId.has(c) || !byId.has(t)) continue;
            edges.push({{ s: c, t, kind: he.kind || "edge", w, he }});
            indeg.set(t, (indeg.get(t)||0)+1);
            outdeg.set(c, (outdeg.get(c)||0)+1);
          }}
        }}
      }}
      const degree = new Map();
      for (const n of nodes) degree.set(n.id, (indeg.get(n.id)||0)+(outdeg.get(n.id)||0));
      let mergeN = 0;
      for (const n of nodes) if ((indeg.get(n.id)||0) >= 2) mergeN++;
      let maxTurn = 0;
      for (const n of nodes) maxTurn = Math.max(maxTurn, nodeTurn(n));
      const simNodes = nodes.map((n,i) => {{
        const d = degree.get(n.id) || 0;
        const m = nodeMass(n,d);
        const r = clamp(2.5 + Math.sqrt(m) * 0.35, 3, 22);
        const t = nodeTurn(n);
        const ang = i*0.37 + t*0.8;
        const rad = 40 + t*70 + (i % 7) * 18;
        return {{ id: n.id, n, turn: t, mass: m, r, x: Math.cos(ang)*rad, y: Math.sin(ang)*rad, vx:0, vy:0 }};
      }});
      const simIndex = new Map(simNodes.map(sn => [sn.id, sn]));
      const simEdges = edges.map(e => ({{ a: simIndex.get(e.s), b: simIndex.get(e.t), kind: e.kind, w: e.w, he: e.he }})).filter(e => e.a && e.b);
      return {{ graph, nodes, hyperedges, edges, simNodes, simEdges, indeg, outdeg, mergeN, maxTurn }};
    }}
    function renderer(state){{
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const tip = document.getElementById("tip");
      let width=0, height=0, dpr=1;
      function resize(){{
        dpr = window.devicePixelRatio || 1;
        width = window.innerWidth; height = window.innerHeight;
        canvas.style.width = width+"px"; canvas.style.height = height+"px"; canvas.style.display="block";
        canvas.width = Math.floor(width*dpr); canvas.height = Math.floor(height*dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }}
      resize(); window.addEventListener("resize", resize);
      const cam = {{ x: width/2, y: height/2, s: 1.0 }};
      const pan = {{ down:false, x:0, y:0, cx:0, cy:0 }};
      canvas.addEventListener("mousedown", (e)=>{{ pan.down=true; pan.x=e.clientX; pan.y=e.clientY; pan.cx=cam.x; pan.cy=cam.y; }});
      window.addEventListener("mouseup", ()=>{{ pan.down=false; }});
      window.addEventListener("mousemove", (e)=>{{ if(pan.down){{ cam.x=pan.cx+(e.clientX-pan.x); cam.y=pan.cy+(e.clientY-pan.y); }} }});
      canvas.addEventListener("wheel",(e)=>{{
        e.preventDefault();
        const k = Math.exp(-e.deltaY*0.0012);
        const s2 = clamp(cam.s*k, 0.18, 3.5);
        const mx=e.clientX,my=e.clientY;
        const wx=(mx-cam.x)/cam.s, wy=(my-cam.y)/cam.s;
        cam.x = mx - wx*s2; cam.y = my - wy*s2; cam.s = s2;
      }}, {{ passive:false }});
      const ui = {{ maxTurn: state.maxTurn, turn: state.maxTurn, pulse: true }};
      const turnEl = document.getElementById("turn");
      const turnVal = document.getElementById("turnVal");
      turnEl.max = String(state.maxTurn);
      turnEl.value = String(state.maxTurn);
      turnVal.textContent = String(state.maxTurn);
      turnEl.addEventListener("input",()=>{{ ui.turn = Number(turnEl.value || "0"); turnVal.textContent = String(ui.turn); }});
      document.getElementById("btnPulse").addEventListener("click",()=>{{ ui.pulse=!ui.pulse; }});
      document.getElementById("btnReset").addEventListener("click",()=>{{ cam.x=width/2; cam.y=height/2; cam.s=1.0; }});
      function visible(sn){{ if (sn.n.kind==="run"||sn.n.kind==="goal") return true; return sn.turn<=ui.turn; }}
      function screen(sn){{ return {{ sx: cam.x + sn.x*cam.s, sy: cam.y + sn.y*cam.s }}; }}
      let hover=null;
      window.addEventListener("mousemove",(e)=>{{
        const mx=e.clientX,my=e.clientY;
        const wx=(mx-cam.x)/cam.s, wy=(my-cam.y)/cam.s;
        let best=null,bestD=1e9;
        for(const sn of state.simNodes){{
          if(!visible(sn)) continue;
          const dx=sn.x-wx, dy=sn.y-wy;
          const d2=dx*dx+dy*dy;
          const rr=(sn.r+6)**2;
          if(d2<rr && d2<bestD){{ bestD=d2; best=sn; }}
        }}
        hover=best;
        if(!hover){{ tip.style.transform="translate(-9999px,-9999px)"; return; }}
        const n=hover.n, d=n.data||{{}};
        const text=d.full_text||d.text||"";
        const label=n.label||n.kind||"node";
        const meta=[`kind: ${{n.kind}}`, `turn: ${{hover.turn}}`].join(" · ");
        tip.innerHTML = `<div style="font-weight:800;">${{label.replace(/</g,"&lt;")}}</div>` +
                        `<div class="k">${{meta.replace(/</g,"&lt;")}}</div>` +
                        (text ? `<div style="margin-top:8px;">${{String(text).slice(0,420).replace(/</g,"&lt;")}}${{String(text).length>420?"…":""}}</div>` : "");
        tip.style.transform = `translate(${{Math.min(mx+14, width-440)}}px, ${{Math.min(my+14, height-240)}}px)`;
      }});
      function stepPhysics(dt){{
        const nodes=state.simNodes, edges=state.simEdges;
        const cell=110; const grid=new Map(); const key=(ix,iy)=>ix+","+iy;
        for(const n of nodes){{ if(!visible(n)) continue; const ix=Math.floor(n.x/cell), iy=Math.floor(n.y/cell); const k=key(ix,iy); if(!grid.has(k)) grid.set(k,[]); grid.get(k).push(n); }}
        const repK=2200;
        for(const n of nodes){{
          if(!visible(n)) continue;
          const ix=Math.floor(n.x/cell), iy=Math.floor(n.y/cell);
          for(let dx=-1; dx<=1; dx++) for(let dy=-1; dy<=1; dy++) {{
            const bucket=grid.get(key(ix+dx,iy+dy)); if(!bucket) continue;
            for(const m of bucket){{ if(m===n) continue; const vx=n.x-m.x, vy=n.y-m.y; const d2=vx*vx+vy*vy+0.01; const min=(n.r+m.r)*1.2; const min2=min*min; const f=(d2<min2)?(repK/d2)*1.6:(repK/d2); n.vx += (vx/Math.sqrt(d2))*f*dt; n.vy += (vy/Math.sqrt(d2))*f*dt; }}
          }}
        }}
        const spring=0.018;
        for(const e of edges){{
          if(!visible(e.a)||!visible(e.b)) continue;
          const dx=e.b.x-e.a.x, dy=e.b.y-e.a.y;
          const dist=Math.sqrt(dx*dx+dy*dy)+0.01;
          const desired=80+(e.a.r+e.b.r)*1.2;
          const f=(dist-desired)*spring*(0.6+e.w);
          const fx=(dx/dist)*f, fy=(dy/dist)*f;
          e.a.vx += fx*dt; e.a.vy += fy*dt; e.b.vx -= fx*dt; e.b.vy -= fy*dt;
        }}
        for(const n of nodes){{
          if(!visible(n)) continue;
          const t=n.turn;
          const targetR=40+t*75;
          const ang=(Math.atan2(n.y,n.x)+Math.PI*2)%(Math.PI*2);
          const tx=Math.cos(ang)*targetR, ty=Math.sin(ang)*targetR;
          n.vx += (tx-n.x)*0.0025*dt;
          n.vy += (ty-n.y)*0.0025*dt;
        }}
        for(const n of nodes){{
          if(!visible(n)) continue;
          const damp=0.86 - clamp((n.mass/500)*0.18,0,0.22);
          n.vx *= damp; n.vy *= damp; n.x += n.vx*dt; n.y += n.vy*dt;
        }}
      }}
      let pulseT=0;
      function draw(dt){{
        ctx.clearRect(0,0,width,height);
        ctx.globalAlpha=0.15; ctx.fillStyle="#ffffff";
        for(let i=0;i<120;i++){{ const x=(i*9973)%width; const y=(i*5419)%height; ctx.fillRect(x,y,1,1); }}
        ctx.globalAlpha=1;
        ctx.lineWidth=1;
        for(const e of state.simEdges){{
          if(!visible(e.a)||!visible(e.b)) continue;
          const A=screen(e.a), B=screen(e.b);
          const col=(e.kind==="tool_effect")?"rgba(122,167,255,0.26)":
                    (e.kind==="flow")?"rgba(255,209,102,0.22)":
                    (e.kind==="invocation")?"rgba(255,93,143,0.22)":
                    "rgba(233,239,255,0.14)";
          ctx.strokeStyle=col;
          ctx.lineWidth=clamp(0.6+e.w*0.55,0.7,2.6);
          ctx.beginPath(); ctx.moveTo(A.sx,A.sy);
          const mx=(A.sx+B.sx)/2, my=(A.sy+B.sy)/2;
          const nx=(B.sy-A.sy)*0.06, ny=(A.sx-B.sx)*0.06;
          ctx.quadraticCurveTo(mx+nx,my+ny,B.sx,B.sy);
          ctx.stroke();
        }}
        if(ui.pulse){{
          pulseT += dt*0.0015;
          for(let i=0; i<state.simEdges.length; i+=6){{
            const e=state.simEdges[i];
            if(!visible(e.a)||!visible(e.b)) continue;
            const A=screen(e.a), B=screen(e.b);
            const t=(pulseT+i*0.017)%1;
            const x=A.sx+(B.sx-A.sx)*t, y=A.sy+(B.sy-A.sy)*t;
            ctx.fillStyle="rgba(255,93,143,0.55)";
            ctx.beginPath(); ctx.arc(x,y,1.1+e.w*0.7,0,Math.PI*2); ctx.fill();
          }}
        }}
        for(const sn of state.simNodes){{
          if(!visible(sn)) continue;
          const {{sx,sy}}=screen(sn);
          const kind=sn.n.kind||"other";
          const col=COLORS[kind]||COLORS.other;
          const glow=clamp(sn.mass/260,0.2,1.2);
          ctx.globalAlpha=0.22; ctx.fillStyle=col;
          ctx.beginPath(); ctx.arc(sx,sy,sn.r*(1.8+glow),0,Math.PI*2); ctx.fill();
          ctx.globalAlpha=1;
          ctx.fillStyle=col;
          ctx.beginPath(); ctx.arc(sx,sy,sn.r,0,Math.PI*2); ctx.fill();
          if(hover && hover.id===sn.id){{
            ctx.strokeStyle="rgba(255,255,255,0.9)";
            ctx.lineWidth=2; ctx.beginPath(); ctx.arc(sx,sy,sn.r+5,0,Math.PI*2); ctx.stroke();
          }}
        }}
      }}
      let last=performance.now();
      function frame(now){{
        const dt=now-last; last=now;
        for(let i=0;i<2;i++) stepPhysics(dt*0.55);
        draw(dt);
        requestAnimationFrame(frame);
      }}
      requestAnimationFrame(frame);
      return {{ cam, ui }};
    }}
    function download(name, text) {{
      const a = document.createElement("a");
      a.href = URL.createObjectURL(new Blob([text], {{type:"application/octet-stream"}}));
      a.download = name;
      a.click();
      setTimeout(() => URL.revokeObjectURL(a.href), 2500);
    }}
    function main(){{
      const state = build(GRAPH);
      document.getElementById("mNodes").textContent = String(state.nodes.length);
      document.getElementById("mEdges").textContent = String(state.edges.length);
      document.getElementById("mCx").textContent = fmt2(state.edges.length / Math.max(1, state.nodes.length));
      document.getElementById("mMerge").textContent = fmt2(state.mergeN / Math.max(1, state.nodes.length));
      document.getElementById("aJson").onclick = (e)=>{{ e.preventDefault(); download("hypergraph.json", JSON.stringify(GRAPH, null, 2)); }};
      document.getElementById("aDot").onclick = (e)=>{{ e.preventDefault(); download("hypergraph.dot", DOT); }};
      renderer(state);
    }}
    main();
  </script>
</body>
</html>